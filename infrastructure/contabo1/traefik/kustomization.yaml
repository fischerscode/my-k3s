bases:
  - ../../base/traefik
  - ../docker-cred

namespace: traefik-system

replicas:
  - name: traefik
    count: 6

secretGenerator:
  - name: traefik-dashboard-users
    namespace: overridden
    files:
      - users=traefik-dashboard-users.txt
  - name: traefik-pilot-token
    namespace: traefik-system
    options:
      disableNameSuffixHash: true
    files:
      - token=pilot-token.encrypted

replacements:
  - source:
      name: traefik-dashboard-auth
      kind: Middleware
      fieldPath: metadata.namespace
    targets:
      - select:
          name: traefik-dashboard-users
          kind: Secret
          version: v1
        fieldPaths:
          - metadata.namespace
